# 前端开发提示词：测款链接监控页面

## 页面功能概述

在【测款链接监控】页面实现以下功能：
1. **店铺选择**：通过下拉选择框（select）选择要查询的店铺
2. **查询测款监控数据**：根据选择的店铺，调用后端接口获取测款商品的监控数据
3. **数据展示**：以表格或卡片形式展示测款商品的监控数据，包括商品信息、点击数、访客数、出单数等

## 后端接口说明

### 测款链接监控接口

**接口地址**: `GET /products/testing-monitor`

**请求参数**:
- `shop` (query参数, 必需): 商店ID（店铺名称），字符串类型

**请求示例**:
```
GET /products/testing-monitor?shop=店铺名称
```

**响应格式**:
```json
{
  "success": true,
  "message": "查询成功",
  "data": [
    {
      "product_id": "12345",
      "product_name": "商品名称1",
      "product_image": "https://example.com/image1.jpg",
      "total_clicks": 1500,
      "total_visitors": 800,
      "total_orders": 50
    },
    {
      "product_id": "67890",
      "product_name": "商品名称2",
      "product_image": "https://example.com/image2.jpg",
      "total_clicks": 0,
      "total_visitors": 200,
      "total_orders": 5
    }
  ]
}
```

**错误响应**:
```json
{
  "success": false,
  "message": "查询失败",
  "error": "具体错误信息"
}
```

**数据结构说明**:
- `product_id`: 产品ID（字符串）
- `product_name`: 产品名称（字符串）
- `product_image`: 产品主图URL（字符串，可为 null）
- `total_clicks`: 测款开始以来的点击数合计（数字，整数）
- `total_visitors`: 测款开始以来的访客数合计（数字，整数）
- `total_orders`: 测款开始以来的出单数合计（数字，整数）

**注意事项**:
- 如果某个商品没有广告数据，`total_clicks` 可能为 0
- 如果某个商品没有每日统计数据，`total_visitors` 和 `total_orders` 可能为 0
- 如果店铺没有处于测款阶段的商品，`data` 数组为空数组 `[]`

## 前端实现要求

### 1. 页面布局

**必需元素**:
- **店铺选择区域**：
  - 标签：`选择店铺` 或 `店铺`
  - 下拉选择框（select）：用于选择店铺
  - 查询按钮：点击后触发数据查询
- **数据展示区域**：
  - 表格或卡片列表：展示测款商品监控数据
  - 加载状态提示：查询时显示 loading
  - 空数据提示：如果没有数据，显示友好提示

### 2. 店铺选择功能

**实现要求**:
- 使用 `<select>` 或下拉选择组件
- 店铺列表可以从以下方式获取：
  - 方式一：从其他接口获取店铺列表（如果有店铺列表接口）
  - 方式二：使用固定的店铺列表（如果店铺数量不多）
  - 方式三：允许用户手动输入店铺名称（如果使用 input）
- 选择店铺后，点击查询按钮触发数据查询
- 建议：如果只有一个店铺，可以自动选中并自动查询

**店铺选择示例**:
```html
<!-- 方式一：下拉选择框 -->
<select id="shopSelect" onChange={handleShopChange}>
  <option value="">请选择店铺</option>
  <option value="店铺1">店铺1</option>
  <option value="店铺2">店铺2</option>
</select>
<button onClick={handleQuery}>查询</button>

<!-- 方式二：输入框 -->
<input 
  type="text" 
  placeholder="请输入店铺名称" 
  value={shop}
  onChange={(e) => setShop(e.target.value)}
/>
<button onClick={handleQuery}>查询</button>
```

### 3. 数据查询功能

**实现步骤**:
1. 用户选择店铺（或输入店铺名称）
2. 点击查询按钮
3. 验证店铺是否已选择（如果为空，提示用户选择店铺）
4. 显示加载状态（loading）
5. 调用 `GET /products/testing-monitor?shop={店铺名称}` 接口
6. 处理响应数据：
   - 如果 `success === true`：显示数据
   - 如果 `success === false`：显示错误提示
7. 隐藏加载状态

**代码示例**:
```typescript
const [shop, setShop] = useState<string>('');
const [loading, setLoading] = useState<boolean>(false);
const [data, setData] = useState<Array<{
  product_id: string;
  product_name: string;
  product_image: string | null;
  total_clicks: number;
  total_visitors: number;
  total_orders: number;
}>>([]);
const [error, setError] = useState<string | null>(null);

const handleQuery = async () => {
  if (!shop) {
    alert('请选择店铺');
    return;
  }

  setLoading(true);
  setError(null);

  try {
    const response = await fetch(`/products/testing-monitor?shop=${encodeURIComponent(shop)}`);
    const result = await response.json();

    if (result.success) {
      setData(result.data || []);
    } else {
      setError(result.error || result.message || '查询失败');
      setData([]);
    }
  } catch (error) {
    setError('网络连接失败，请检查网络后重试');
    setData([]);
  } finally {
    setLoading(false);
  }
};
```

### 4. 数据展示功能

**展示要求**:
- **表格形式**（推荐）：
  - 表头：商品ID、商品名称、商品主图、点击数、访客数、出单数
  - 每行显示一个商品的监控数据
  - 商品主图显示为缩略图（如果有）
  - 数字字段右对齐，便于对比

- **卡片形式**（可选）：
  - 每个卡片显示一个商品的完整信息
  - 包含商品图片、名称、ID
  - 显示三个关键指标：点击数、访客数、出单数

**数据展示示例**:
```html
<!-- 表格形式 -->
<table>
  <thead>
    <tr>
      <th>商品ID</th>
      <th>商品名称</th>
      <th>商品主图</th>
      <th>点击数</th>
      <th>访客数</th>
      <th>出单数</th>
    </tr>
  </thead>
  <tbody>
    {data.map((item) => (
      <tr key={item.product_id}>
        <td>{item.product_id}</td>
        <td>{item.product_name}</td>
        <td>
          {item.product_image ? (
            <img src={item.product_image} alt={item.product_name} style={{ width: '50px', height: '50px' }} />
          ) : (
            <span>无图片</span>
          )}
        </td>
        <td style={{ textAlign: 'right' }}>{item.total_clicks.toLocaleString()}</td>
        <td style={{ textAlign: 'right' }}>{item.total_visitors.toLocaleString()}</td>
        <td style={{ textAlign: 'right' }}>{item.total_orders.toLocaleString()}</td>
      </tr>
    ))}
  </tbody>
</table>

<!-- 空数据提示 -->
{!loading && data.length === 0 && (
  <div>暂无测款商品数据</div>
)}
```

### 5. 加载状态和错误处理

**加载状态**:
- 查询时显示 loading 动画或禁用查询按钮
- 可以显示 "查询中..." 文字提示

**错误处理**:
- **网络错误**：显示 "网络连接失败，请检查网络后重试"
- **接口错误**：显示后端返回的 `error` 字段内容
- **参数错误**：如果店铺为空，提示 "请选择店铺"
- **空数据**：如果没有测款商品，显示友好提示 "当前店铺暂无测款商品"

**错误处理示例**:
```typescript
{error && (
  <div className="error-message" style={{ color: 'red' }}>
    {error}
  </div>
)}

{loading && (
  <div className="loading">查询中...</div>
)}

{!loading && !error && data.length === 0 && (
  <div className="empty-message">当前店铺暂无测款商品</div>
)}
```

### 6. 用户体验优化

**建议优化**:
- **自动查询**：选择店铺后自动触发查询（可选）
- **数据格式化**：数字使用千分位格式化（如：1,500）
- **图片加载失败处理**：如果商品图片加载失败，显示占位图
- **响应式设计**：适配不同屏幕尺寸
- **数据刷新**：提供刷新按钮，可以重新查询
- **统计汇总**：可选：在表格底部显示总计行（所有商品的点击数、访客数、出单数合计）

**数字格式化示例**:
```typescript
const formatNumber = (num: number): string => {
  return num.toLocaleString('zh-CN');
};

// 使用
<td>{formatNumber(item.total_clicks)}</td>
```

### 7. 完整代码结构建议

**组件结构**:
```typescript
interface TestingMonitorData {
  product_id: string;
  product_name: string;
  product_image: string | null;
  total_clicks: number;
  total_visitors: number;
  total_orders: number;
}

const TestingMonitorPage = () => {
  // 状态管理
  const [shop, setShop] = useState<string>('');
  const [shops, setShops] = useState<string[]>([]); // 店铺列表
  const [loading, setLoading] = useState<boolean>(false);
  const [data, setData] = useState<TestingMonitorData[]>([]);
  const [error, setError] = useState<string | null>(null);

  // 查询函数
  const handleQuery = async () => {
    // 实现查询逻辑
  };

  // 店铺选择变化
  const handleShopChange = (e: React.ChangeEvent<HTMLSelectElement>) => {
    setShop(e.target.value);
  };

  return (
    <div className="testing-monitor-page">
      {/* 店铺选择区域 */}
      <div className="shop-selector">
        <label>选择店铺：</label>
        <select value={shop} onChange={handleShopChange}>
          <option value="">请选择店铺</option>
          {shops.map((s) => (
            <option key={s} value={s}>{s}</option>
          ))}
        </select>
        <button onClick={handleQuery} disabled={loading || !shop}>
          {loading ? '查询中...' : '查询'}
        </button>
      </div>

      {/* 错误提示 */}
      {error && <div className="error">{error}</div>}

      {/* 数据展示 */}
      {!loading && data.length > 0 && (
        <table>
          {/* 表格内容 */}
        </table>
      )}

      {/* 空数据提示 */}
      {!loading && !error && data.length === 0 && shop && (
        <div className="empty">当前店铺暂无测款商品</div>
      )}
    </div>
  );
};
```

### 8. API 调用函数

**推荐封装**:
```typescript
// api.ts 或 services.ts
export async function getTestingMonitorData(shop: string): Promise<TestingMonitorData[]> {
  const response = await fetch(`/products/testing-monitor?shop=${encodeURIComponent(shop)}`);
  const result = await response.json();

  if (!result.success) {
    throw new Error(result.error || result.message || '查询失败');
  }

  return result.data || [];
}
```

**使用**:
```typescript
try {
  const data = await getTestingMonitorData(shop);
  setData(data);
} catch (error) {
  setError(error instanceof Error ? error.message : '查询失败');
}
```

## 完整实现示例（伪代码）

```typescript
import React, { useState, useEffect } from 'react';

interface TestingMonitorData {
  product_id: string;
  product_name: string;
  product_image: string | null;
  total_clicks: number;
  total_visitors: number;
  total_orders: number;
}

const TestingMonitorPage: React.FC = () => {
  const [shop, setShop] = useState<string>('');
  const [shops] = useState<string[]>(['店铺1', '店铺2', '店铺3']); // 店铺列表，可以从接口获取
  const [loading, setLoading] = useState<boolean>(false);
  const [data, setData] = useState<TestingMonitorData[]>([]);
  const [error, setError] = useState<string | null>(null);

  // 查询测款监控数据
  const handleQuery = async () => {
    if (!shop) {
      setError('请选择店铺');
      return;
    }

    setLoading(true);
    setError(null);

    try {
      const response = await fetch(
        `/products/testing-monitor?shop=${encodeURIComponent(shop)}`
      );
      const result = await response.json();

      if (result.success) {
        setData(result.data || []);
        if (result.data.length === 0) {
          setError('当前店铺暂无测款商品');
        }
      } else {
        setError(result.error || result.message || '查询失败');
        setData([]);
      }
    } catch (err) {
      setError('网络连接失败，请检查网络后重试');
      setData([]);
    } finally {
      setLoading(false);
    }
  };

  // 数字格式化
  const formatNumber = (num: number): string => {
    return num.toLocaleString('zh-CN');
  };

  return (
    <div style={{ padding: '20px' }}>
      <h1>测款链接监控</h1>

      {/* 店铺选择区域 */}
      <div style={{ marginBottom: '20px' }}>
        <label style={{ marginRight: '10px' }}>选择店铺：</label>
        <select
          value={shop}
          onChange={(e) => setShop(e.target.value)}
          style={{ marginRight: '10px', padding: '5px' }}
        >
          <option value="">请选择店铺</option>
          {shops.map((s) => (
            <option key={s} value={s}>
              {s}
            </option>
          ))}
        </select>
        <button
          onClick={handleQuery}
          disabled={loading || !shop}
          style={{ padding: '5px 15px' }}
        >
          {loading ? '查询中...' : '查询'}
        </button>
      </div>

      {/* 错误提示 */}
      {error && (
        <div style={{ color: 'red', marginBottom: '20px' }}>{error}</div>
      )}

      {/* 加载状态 */}
      {loading && <div>查询中...</div>}

      {/* 数据表格 */}
      {!loading && data.length > 0 && (
        <table
          style={{
            width: '100%',
            borderCollapse: 'collapse',
            border: '1px solid #ddd',
          }}
        >
          <thead>
            <tr style={{ backgroundColor: '#f5f5f5' }}>
              <th style={{ padding: '10px', border: '1px solid #ddd' }}>
                商品ID
              </th>
              <th style={{ padding: '10px', border: '1px solid #ddd' }}>
                商品名称
              </th>
              <th style={{ padding: '10px', border: '1px solid #ddd' }}>
                商品主图
              </th>
              <th
                style={{
                  padding: '10px',
                  border: '1px solid #ddd',
                  textAlign: 'right',
                }}
              >
                点击数
              </th>
              <th
                style={{
                  padding: '10px',
                  border: '1px solid #ddd',
                  textAlign: 'right',
                }}
              >
                访客数
              </th>
              <th
                style={{
                  padding: '10px',
                  border: '1px solid #ddd',
                  textAlign: 'right',
                }}
              >
                出单数
              </th>
            </tr>
          </thead>
          <tbody>
            {data.map((item) => (
              <tr key={item.product_id}>
                <td style={{ padding: '10px', border: '1px solid #ddd' }}>
                  {item.product_id}
                </td>
                <td style={{ padding: '10px', border: '1px solid #ddd' }}>
                  {item.product_name}
                </td>
                <td style={{ padding: '10px', border: '1px solid #ddd' }}>
                  {item.product_image ? (
                    <img
                      src={item.product_image}
                      alt={item.product_name}
                      style={{ width: '50px', height: '50px', objectFit: 'cover' }}
                      onError={(e) => {
                        e.currentTarget.src = '/placeholder-image.png'; // 占位图
                      }}
                    />
                  ) : (
                    <span style={{ color: '#999' }}>无图片</span>
                  )}
                </td>
                <td
                  style={{
                    padding: '10px',
                    border: '1px solid #ddd',
                    textAlign: 'right',
                  }}
                >
                  {formatNumber(item.total_clicks)}
                </td>
                <td
                  style={{
                    padding: '10px',
                    border: '1px solid #ddd',
                    textAlign: 'right',
                  }}
                >
                  {formatNumber(item.total_visitors)}
                </td>
                <td
                  style={{
                    padding: '10px',
                    border: '1px solid #ddd',
                    textAlign: 'right',
                  }}
                >
                  {formatNumber(item.total_orders)}
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      )}

      {/* 空数据提示 */}
      {!loading && !error && data.length === 0 && shop && (
        <div style={{ textAlign: 'center', padding: '40px', color: '#999' }}>
          当前店铺暂无测款商品
        </div>
      )}
    </div>
  );
};

export default TestingMonitorPage;
```

## 注意事项

1. **店铺列表获取**：如果项目中有店铺列表接口，优先使用接口获取；如果没有，可以使用固定列表或允许用户输入
2. **URL 编码**：使用 `encodeURIComponent()` 对店铺名称进行编码，避免特殊字符问题
3. **数据为空处理**：如果 `data` 为空数组，显示友好提示而不是错误
4. **图片加载**：商品图片可能为 null，需要处理图片加载失败的情况
5. **数字格式化**：使用 `toLocaleString()` 格式化数字，提升可读性
6. **响应式设计**：如果使用表格，在小屏幕上考虑使用卡片布局或横向滚动

## 测试要点

1. 测试店铺选择：选择不同店铺，验证数据是否正确
2. 测试空数据：选择没有测款商品的店铺，验证空数据提示
3. 测试网络错误：模拟网络错误，验证错误提示
4. 测试加载状态：验证查询时是否正确显示 loading
5. 测试数据展示：验证所有字段是否正确显示
6. 测试图片加载：验证商品图片是否正确显示，加载失败时是否显示占位图

